<div class="post">
  <% if action.of_type? :event_created  %>
    <% if action.action %>
    <%# It's a nested action (1 level deep) and therefore should show more details about the event %>
      <%= render 'explore/event.html', :event => action.event %>
    <% else %>

      <%-
      title = action.user.try(:name) ? "#{link_to(action.user.try(:name), profile_path(action.user))}" : "The owner"
      title += " created #{link_to action.event.name, event_path(action.event)}"
      -%>

      <%= render 'shared/general_action.html',
        :action => action,
        :url_for_image => url_for_avatar(action.user),
        :link_for_image => profile_path(action.user),
        :title => title
    %>
    <% end %>
  <% elsif action.of_type? :event_rsvp_attending %>

    <%-
    title = action.user.try(:name) ? "#{link_to(action.user.try(:name), profile_path(action.user))}" : "The owner"
    title += " is attending #{link_to action.event.name, event_path(action.event)}"
    -%>

    <%= render 'shared/general_action.html',
      :action => action,
      :url_for_image => url_for_avatar(action.user),
      :link_for_image => profile_path(action.user),
      :title => title
  %>
  <% elsif action.of_type?(:event_comment) %>
    <%= render 'shared/general_action.html',
      :action => action,
      :url_for_image => url_for_avatar(action.user),
      :link_for_image => profile_path(action.user),
      :title => "#{action.user.try(:name) || "The owner"} made a comment.",
      :body => action.reference.body
  %>
  <% elsif action.of_type?(:action_comment) %>

    <%-
    title = action.user.try(:name) ? "#{link_to(action.user.try(:name), profile_path(action.user))}" : "The owner"
    title += " #{action.reference.body}."
    -%>

    <%= render 'shared/general_action.html',
      :action => action,
      :url_for_image => url_for_avatar(action.user),
      :link_for_image => profile_path(action.user),
      :title => title
  %>
  <% elsif action.of_type?(:search_comment) %>

    <%-
    title = action.user.try(:name) ? "#{link_to(action.user.try(:name), profile_path(action.user))}" : "The owner"
    title += " made a comment on this search filter."
    -%>

    <%= render 'shared/general_action.html',
      :action => action,
      :url_for_image => url_for_avatar(action.user),
      :link_for_image => profile_path(action.user),
      :title => title,
      :body => action.reference.body
  %>
  <% elsif action.of_type?(:profile_comment) %>

    <%-
    title = action.user.try(:name) ? "#{link_to(action.user.try(:name), profile_path(action.user))}" : "The owner"
    title += " posted a message to #{link_to(action.to_user.try(:name), profile_path(action.to_user))}"
    -%>

    <%= render 'shared/general_action.html',
      :action => action,
      :url_for_image => url_for_avatar(action.user),
      :link_for_image => profile_path(action.user),
      :title => title,
      :body => action.reference.body
  %>
  <% end %>

  <%- #"#{action.user.try(:name) || "The owner"} made a comment to #{action.to_user.name}." -%>
</div>