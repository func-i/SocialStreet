<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content ="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta property="fb:app_id" content="<%=FACEBOOK_APP_ID%>" />
    <title>SocialStreet <%= " - #{truncate(@page_title, :length => 30)}" if @page_title %></title>
    <link rel="apple-touch-icon"
          href="/images/app_icon.png" />

    <%= include_javascripts :init %>
    <%= javascript_include_tag "http://code.jquery.com/jquery-1.6.4.min.js", "http://code.jquery.com/mobile/1.0rc2/jquery.mobile-1.0rc2.min.js", "http://maps.google.com/maps/api/js?v=3.5&sensor=true", "http://connect.facebook.net/en_US/all.js"  %>
    <%= include_javascripts :common %>
    <%= stylesheet_link_tag "http://code.jquery.com/mobile/1.0rc2/jquery.mobile-1.0rc2.min.css" %>
    <%= include_stylesheets :common %>

  </head>

  <body>

    <input type="hidden" id="users-current-location" name="users-current-location" value="<%=users_current_location_string()%>"/> 
    <%= yield %>


  </body>
</html>


<script type='text/javascript'>

  $(function() {
    if(-1 == document.cookie.indexOf('current_location_latitude') || -1 == document.cookie.indexOf('current_location_longitude'))
    {
        if(navigator.geolocation){
            navigator.geolocation.getCurrentPosition(function(e){
                updateUserLocation(e.coords.latitude, e.coords.longitude, true)
            }, function(e){
                },
                {
                    maximumAge: 600000
                });
        }
    }
})
</script>